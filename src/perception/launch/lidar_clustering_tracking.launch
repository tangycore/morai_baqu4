<launch>
  <!-- LiDAR Clustering Node for MORAI Simulator -->
  <!-- Modified: Ego vehicle filtering by bounding box instead of min_x -->
  
  <arg name="lidar_topic"           default="/front_lidar/velodyne_points"/>
  <arg name="output_frame"          default="base_link"/>
  <arg name="cluster_result_topic"  default="cluster_result"/>
  
  <!-- Clustering parameters -->
  <arg name="cluster_tolerance"     default="0.8"/>      <!-- 0.6 → 0.8: 측면 차량 연결 개선 -->
  <arg name="min_cluster_size"      default="15"/>       <!-- 20 → 15: 작은 클러스터도 허용 -->
  <arg name="max_cluster_size"      default="8000"/>
  
  <!-- Filtering parameters (base_link 기준) -->
  <arg name="max_distance"          default="60.0"/>     
  <arg name="min_x"                 default="-5.0"/>     <!--  5.0 → -5.0: 측면/후방 차량 감지 -->
  <arg name="min_y"                 default="-5.0"/>    
  <arg name="max_y"                 default="5.0"/>
  <arg name="min_z"                 default="-1.0"/>     <!-- 0.0 → -1.0: 지면 포함 -->         
  <arg name="max_z"                 default="5.0"/>      
    
   
  <node pkg="lidar_clustering" type="lidar_clustering_node" name="lidar_cluster_node" output="screen">
    <param name="lidar_topic"           value="$(arg lidar_topic)"/>
    <param name="output_frame"          value="$(arg output_frame)"/>
    <param name="cluster_result_topic"  value="$(arg cluster_result_topic)"/>
    
    <param name="cluster_tolerance"     value="$(arg cluster_tolerance)"/>
    <param name="min_cluster_size"      value="$(arg min_cluster_size)"/>
    <param name="max_cluster_size"      value="$(arg max_cluster_size)"/>
    
    <param name="max_distance"          value="$(arg max_distance)"/>
    <param name="min_x"                 value="$(arg min_x)"/>
    <param name="max_z"                 value="$(arg max_z)"/>
    <param name="min_z"                 value="$(arg min_z)"/>
    <param name="max_y"                 value="$(arg max_y)"/>
    <param name="min_y"                 value="$(arg min_y)"/>   
  </node>

</launch>
